import{aW as i,bJ as d,aC as n}from"./index.bc90a1a6.js";import{u as l}from"./useNotify.98763d5b.js";const{supabase:s}=n(),{notifyError:m,notifySuccess:c}=l(),a="periodos",p=i("periodos",{state:()=>({periodos:[]}),getters:{periodosCountByEscolaId:r=>o=>r.periodos.filter(e=>e.escola_id===o).length},actions:{async getAllPeriodos(r){console.log(r);try{const{data:o,error:e}=await s.from(a).select("*, escola:escola_id(*)").eq("escola_id",r);if(e)throw e.message;return console.log(o),this.periodos=o}catch(o){console.log(o)}},async addPeriodo(r){try{const{data:o,error:e}=await s.from(a).insert([{nome_periodo:r.nome_periodo,descricao:r.descricao,escola_id:r.escola_id}]);if(e)throw e.message;return c("Pr\xEDodo cadastrado com sucesso"),this.periodos=o}catch{}},async getPeriodoById(r){try{const{data:o,error:e}=await s.from(a).select("*").eq("id",r).single();if(e)throw e.message;return o}catch(o){console.log(o)}},async updatePeriodoById(r,o){try{const{data:e,error:t}=await s.from(a).update({nome_periodo:o.nome_periodo,descricao:o.descricao,escola_id:o.escola_id}).eq("id",r);if(t)throw t.message;return c("Pr\xEDodo actualizado com sucesso"),e}catch(e){console.log(e)}},async deletePeriodoById(r){try{d.create({title:"Confirme",message:"Voc\xEA tens a certeza que pretendes apagar este per\xEDodo?",cancel:!0,persistent:!0}).onOk(async()=>{const{data:o,error:e}=await s.from(a).delete().match({id:r});if(e)throw e;return c("Per\xEDodo apagado com sucesso"),o}).onCancel(()=>{console.log("Deletion canceled")})}catch(o){console.log(o)}},async getEscolaIdByEmail(r){try{const{data:o,error:e}=await s.from("escolas").select("id").eq("email",r);if(e)throw e.message;return o[0].id}catch(o){console.log(o)}}}});export{p as u};
