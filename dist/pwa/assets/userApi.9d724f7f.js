import{aA as m,r as N,C as O,aB as P,aC as W}from"./index.bc90a1a6.js";import{u as z}from"./use-quasar.c935fd80.js";let p;const G=new Uint8Array(16);function L(){if(!p&&(p=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!p))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return p(G)}const s=[];for(let t=0;t<256;++t)s.push((t+256).toString(16).slice(1));function M(t,i=0){return s[t[i+0]]+s[t[i+1]]+s[t[i+2]]+s[t[i+3]]+"-"+s[t[i+4]]+s[t[i+5]]+"-"+s[t[i+6]]+s[t[i+7]]+"-"+s[t[i+8]]+s[t[i+9]]+"-"+s[t[i+10]]+s[t[i+11]]+s[t[i+12]]+s[t[i+13]]+s[t[i+14]]+s[t[i+15]]}const H=typeof crypto!="undefined"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var g={randomUUID:H};function Q(t,i,l){if(g.randomUUID&&!i&&!t)return g.randomUUID();t=t||{};const u=t.random||(t.rng||L)();if(u[6]=u[6]&15|64,u[8]=u[8]&63|128,i){l=l||0;for(let c=0;c<16;++c)i[l+c]=u[c];return i}return M(u)}function $(){return{setBrand:(i,l)=>{i&&m("primary",i),l&&m("secondary",l)}}}const _=N({name:"",phone:"",primary:"",secondary:""});function X(){const{user:t,getToken:i}=O(),l=z(),u=Q(),{supabase:c,supabaseAdmin:w}=W(),{setBrand:y}=$(),b=async(n,a)=>{const{data:o,error:e}=await c.from(n).select("*").eq("user_id",a);if(e)throw e;return o},v=async n=>{const{data:a,error:o}=await c.from(n).select(`
      id,
      *,
      escolas (id, name), categorias (id, categoria)
    `);if(o)throw o;return a},U=async(n,a)=>{const{data:o,error:e}=await c.from(n).select(`
      id,
      *,
      escolas (id, name), categorias (id, categoria)
    `).eq("id",a);if(e)throw e;return o},x=async(n,a)=>{const{data:o,error:e,count:d}=await c.from(n).select("*",{count:"exact"}).eq("user_id",a);if(e)throw e;return{data:o,count:d}},A=async(n,a)=>{const{data:o,error:e}=await c.from(n).select().eq("id",a);if(e)throw e;return o[0]},q=async(n,a)=>{const{data:o,error:e}=await c.from(n).insert({...a,user_id:t.value.id});if(e)throw e;return o},I=async(n,a)=>{const{data:o,error:e}=await c.from(n).insert({name:a.name,nome_pai:a.nome_pai,nome_mae:a.nome_mae,num_agente:a.num_agente,num_bilhete:a.num_bilhete,phone:a.phone,data_emissao:a.data_emissao,data_caducidade:a.data_caducidade,data_nascimento:a.data_nascimento,num_conta_bancaria:a.num_conta_bancaria,email:a.email,genero:a.genero,data_inicio_funcao:a.data_inicio_funcao,provincia:a.data_inicio_funcao,municipio:a.municipio,comuna:a.comuna,localidade:a.localidade,status_nomeacao:a.status_nomeacao,categoria_id:a.categoria_id,escola_id:a.escola_id,habilitacao:a.habilitacao,area_formacao:a.area_formacao,instituto_formacao:a.instituto_formacao,img_url:a.img_url,file_name:a.file_name,salario_base:a.salario_base,salario_liquido:a.salario_liquido,nivelAcademico:a.nivelAcademico,salario_base_extenso:a.salario_base_extenso,salario_liquido_extenso:a.salario_liquido_extenso,cituacao_funcionario:a.cituacao_funcionario,estado_civil:a.estado_civil,balcao_domicilio:a.balcao_domicilio,balcao_domicilio_provincia:a.balcao_domicilio_provincia,balcao_domicilio_municipio:a.balcao_domicilio_municipio,user_id:t.value.id});if(h(a),e)throw e;return o},C=async(n,a)=>{const{data:o,error:e}=await c.from(n).insert({name:a.name,numero:a.numero,num_decreto:a.num_decreto,provincia:a.provincia,municipio:a.municipio,natureza_escola:a.natureza_escola,tipo_escola:a.tipo_escola,salas_professores:a.salas_professores,salas_alunos:a.salas_alunos,email:a.email,phone:a.phone,role:a.role,user_id:t.value.id});if(h(a),e)throw e;return o},h=async n=>{const{data:{user:a},error:o}=await w.auth.admin.createUser({email:n.email,password:n.password,user_metadata:{name:n.name,email:n.email,phone:n.phone,role:n.role,status:!0}});if(P(n),j(n.email),o)throw o;return a},E=async(n,a)=>{const{data:o,error:e}=await c.from(n).update({...a}).match({id:a.id});if(e)throw e;return o},B=async(n,a)=>{const{data:o,error:e}=await c.from(n).delete().match({id:a});if(e)throw e;return o},D=async(n,a)=>{const{data:o,error:e}=await c.storage.from(a).upload(u,n,{cacheControl:3600,upsert:!1}),d=await S(u,a);if(e)throw e;return d},S=async(n,a)=>{const{data:o,error:e}=await c.storage.from(a).getPublicUrl(n);if(e)throw e;return console.log(o.publicUrl),o.publicUrl},k=async()=>{var a;const n=(a=t==null?void 0:t.value)==null?void 0:a.id;if(n){l.loading.show();const{data:o,error:e}=await c.from("config").select("*").eq("user_id",n);if(e)throw e;return o.length>0&&(_.value=o[0],y(_.value.primary,_.value.secondary)),l.loading.hide(),_}},R=async n=>{const{data:a,error:o}=await c.from(n).select("genero");if(o)throw o;const e={};a.forEach(r=>{e[r.genero]=(e[r.genero]||0)+1});const d=[["G\xEAnero","Total de Funcion\xE1rios"]];return Object.keys(e).forEach(r=>{d.push([r,e[r]])}),d},V=async n=>{const{data:a,error:o}=await c.from(n).select("nivelAcademico");if(o)throw o;const e={};a.forEach(r=>{e[r.nivelAcademico]=(e[r.nivelAcademico]||0)+1});const d=[["Nivel","Total"]];return Object.keys(e).forEach(r=>{d.push([r,e[r]])}),console.log(d),d},T=async n=>{const{data:a,error:o}=await c.from(n).select("*");if(o)throw o;return a},j=async n=>{const{data:a,error:o}=await c.auth.signInWithOtp({email:n});if(o)throw o;console.log("link magico enviado com sucesso")};return{list:b,getById:A,post:q,uploadImage:D,graficos:T,update:E,remove:B,fileName:u,getBrand:k,brand:_,getFuncionariosWithCategoriasAndEscolas:v,getFuncionarioWithCategoriasAndEscolas:U,fetchCount:x,totalFuncionatioPorGenero:R,totalFuncionatioPornivel:V,postEscola:C,postFuncionario:I}}export{$ as a,X as u};
