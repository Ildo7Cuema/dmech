import{_ as Q,r as d,f as M,w as C,p as f,q as U,s as c,t as e,aS as y,F as N,G as p,y as m,bq as K,aZ as z,H as r,aR as P,J as Y,I as v,aT as T,bm as O,x as V,L as X,M as $,C as oo,z as lo,E as q,Q as A}from"./index.e70dc7e8.js";import{Q as W}from"./QSpace.cccfce51.js";import{Q as eo}from"./QTd.e931d9bd.js";import{Q as ao}from"./QTable.324e303e.js";import{u as so}from"./disciplinas.81aefc90.js";import{u as io}from"./cursos.717f0f89.js";import{Q as no}from"./QSelect.9e4cb652.js";import{Q as to}from"./QEditor.90438bbc.js";import{Q as ro}from"./QForm.7b26f9a5.js";import{C as j}from"./ClosePopup.39a76e78.js";import{h as co}from"./moment.40bc58bf.js";import"./QList.9cd80ca5.js";import"./use-fullscreen.63635d9e.js";import"./useNotify.e83fbf31.js";import"./position-engine.1f1eaf41.js";import"./selection.ded15137.js";import"./QItemLabel.f0026656.js";import"./QMenu.704bcb1b.js";import"./rtl.b51694b1.js";import"./QBtnDropdown.7820ddaf.js";import"./QTooltip.8d7a7274.js";const mo={props:{nome:String,cursos:Array,disciplina:Object,showModal:Boolean,loading:Boolean,isEditForm:Boolean},emits:["save"],setup(a,{emit:s}){const l=d({nome_disciplina:"",curso_id:[],escola_id:"",descricao:""}),o=()=>{s("save",{...l.value,curso_id:[...l.value.curso_id]})},_=()=>{l.value={nome_disciplina:"",curso_id:[],escola_id:"",descricao:""}},h=d(!1),i=M(()=>a.nome.endsWith("a")?"da":"do"),g=M(()=>a.nome.endsWith("a")?"nova":"novo");return C(()=>a.disciplina,n=>{n&&(l.value={...n,curso_id:Array.isArray(n.curso_id)?n.curso_id:[]})},{immediate:!0}),C(()=>a.showModal,n=>{show.value=n}),C(()=>a.isEditForm,n=>{h.value=n}),C(()=>a.loading,n=>{n||_()}),{form:l,emitForm:o,artigo1:i,artigo2:g,show:d(a.showModal),statusForm:d(a.isEditForm),closeForm:_}}},uo={key:0,class:"q-ml-sm"},fo={key:1,class:"q-ml-sm"},_o={class:"col-12"};function ho(a,s,l,o,_,h){return f(),U(O,{modelValue:o.show,"onUpdate:modelValue":s[3]||(s[3]=i=>o.show=i),persistent:""},{default:c(()=>[e(T,null,{default:c(()=>[e(y,{class:"row items-center"},{default:c(()=>[e(N,{icon:l.isEditForm?"mdi-file-edit":"mdi-book",color:l.isEditForm?"green-9":"dark","text-color":"white"},null,8,["icon","color"]),l.isEditForm?(f(),p("span",uo,"Alterar "+m(l.nome),1)):(f(),p("span",fo,"Cadastro de "+m(o.artigo2)+" "+m(l.nome),1))]),_:1}),e(ro,{onSubmit:K(o.emitForm,["prevent"])},{default:c(()=>[e(y,{class:"row q-col-gutter-sm"},{default:c(()=>[e(z,{modelValue:o.form.nome_disciplina,"onUpdate:modelValue":s[0]||(s[0]=i=>o.form.nome_disciplina=i),label:"Nome"+o.artigo1+" "+l.nome,dense:"",outlined:"",clearable:"",placeholder:l.nome,class:"col-xs-12 col-sm-12 col-md-6 col-lg-6",rules:[i=>!!i||"Por favor informe o nome "+o.artigo1+" "+l.nome]},null,8,["modelValue","label","placeholder","rules"]),e(no,{modelValue:o.form.curso_id,"onUpdate:modelValue":s[1]||(s[1]=i=>o.form.curso_id=i),label:"Cursos",dense:"",outlined:"",clearable:"",multiple:"",placeholder:"Selecione um ou mais cursos",class:"col-xs-12 col-sm-12 col-md-6 col-lg-6",options:l.cursos,rules:[i=>i&&i.length>0||"Por favor selecione pelo menos um curso"],"option-value":"id","option-label":"nome_curso","map-options":"","emit-value":""},null,8,["modelValue","options","rules"]),r("div",_o,[e(to,{modelValue:o.form.descricao,"onUpdate:modelValue":s[2]||(s[2]=i=>o.form.descricao=i),label:"Descri\xE7\xE3o",dense:"",outlined:"",clearable:"",placeholder:"Descri\xE7\xE3o"},null,8,["modelValue"])])]),_:1}),e(P,{class:"bg-grey-3"},{default:c(()=>[Y(e(v,{outline:"","no-caps":"",label:"Cancelar",color:"red-9",icon:"mdi-close",onClick:o.closeForm},null,8,["onClick"]),[[j]]),e(W),e(v,{type:"submit",outline:"","no-caps":"",label:l.isEditForm?"Atualizar":"Cadastrar",color:"green-10",icon:l.isEditForm?"mdi-update":"mdi-database-plus",loading:l.loading},null,8,["label","icon","loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])}var vo=Q(mo,[["render",ho]]);const go={props:{nome:String,showModal2:Boolean,disciplinasCursos:{type:Array,required:!0},showInformation:{type:Object,required:!0}},setup(a){const s=co(a.showInformation.created_at).format("DD/MM/YYYY"),l=M(()=>a.nome.endsWith("a")?"da":"do");return{momentDate:s,artigo:l,showInfor:d(a.showModal2)}}},po={class:"q-ml-sm"},wo=r("b",null,"Nome da disciplina: ",-1),bo={class:"text-red-10"},Co={class:"col-12"},yo=r("b",null,"Nome da escola: ",-1),Vo={class:"col-12"},Io=r("b",{class:"text-red-9"},"Cursos a que a disciplina pertence: ",-1),Fo=r("b",null,"Data de registo:",-1);function Mo(a,s,l,o,_,h){return f(),U(O,{modelValue:o.showInfor,"onUpdate:modelValue":s[0]||(s[0]=i=>o.showInfor=i),persistent:""},{default:c(()=>[e(T,null,{default:c(()=>[e(y,{class:"row items-center"},{default:c(()=>[e(N,{icon:"mdi-information-outline",color:"blue-4","text-color":"white",size:"50px"}),r("span",po,"Mais informa\xE7\xF5es "+m(o.artigo)+" "+m(l.nome),1)]),_:1}),e(y,{class:"row q-col-gutter-sm"},{default:c(()=>[r("p",null,[wo,r("span",bo,m(l.showInformation.nome_disciplina),1)]),r("div",Co,[r("p",null,[yo,V(m(l.showInformation.escola.name),1)])]),r("div",Vo,[Io,r("ul",null,[(f(!0),p($,null,X(l.disciplinasCursos,i=>(f(),p("li",{key:i.id},m(i.cursos.nome_curso),1))),128))])]),r("p",null,[Fo,V(" "+m(o.momentDate),1)])]),_:1}),e(P,{class:"bg-grey-3"},{default:c(()=>[Y(e(v,{outline:"","no-caps":"",label:"Fechar",color:"red-9",icon:"mdi-close"},null,512),[[j]])]),_:1})]),_:1})]),_:1},8,["modelValue"])}var Qo=Q(go,[["render",Mo]]);const Do=[{name:"nome_disciplina",label:"Nome da disciplina",align:"left",field:"nome_disciplina",sortable:!0},{name:"escola.name",label:"Minha escola",align:"left",field:a=>a.escola.name,sortable:!0},{name:"options",label:"Op\xE7\xF5es",align:"left",field:"options",sortable:!0}],ko={components:{DisciplinasForm:vo,showInformation:Qo},setup(){const a=d(!1),s=d(!1),{user:l}=oo(),o=d(!1),h=new Date().getFullYear(),{addDisciplina:i,disciplinasCountByEscolaId:g,deleteDisciplinaById:n,getAllDisciplinas:I,getDisciplinaById:Ao,updateDisciplinaById:L,getEscolaIdByEmail:D,disciplinaCursos:G}=so(),{getAllCursos:H}=io(),w=d(""),F=d(!1),J=d(""),R=d(""),k=d({}),S=d([]),x=d({}),E=d([]),B=d([]);lo(()=>{b(),Z()});const b=()=>{a.value=!0,D(l.value.email).then(t=>{w.value=t,I(t).then(u=>{E.value=u,a.value=!1})})},Z=()=>{a.value=!0,D(l.value.email).then(t=>{w.value=t,H(t).then(u=>{S.value=u,a.value=!1})})};return{rows:E,columns:Do,search:J,filter:R,loading:a,edit:t=>{console.log(t),k.value={...t},s.value=!0,F.value=!0},remove:async t=>{a.value=!0;try{await n(t),b()}catch(u){console.log(u)}finally{b(),a.value=!1}},formModal:t=>{s.value=!1,F.value=!0},disciplina:k,showModal:F,handleSave:async t=>{console.log(t);try{a.value=!0,t.escola_id=w.value,t.ano=h,s.value?await L(t.id,t):await i(t)}catch(u){console.log(u)}finally{a.value=!1,b()}},formStatus:s,disciplinasCountByEscolaId:g,escolaId:w,information:async t=>{console.log(t),x.value={...t},await G(t.id).then(u=>{B.value=u}),o.value=!0},showModal2:o,DisciplinaInfo:x,cursos:S,disciplinasCursos:B}}},So=r("br",null,null,-1),xo=r("br",null,null,-1),Eo={class:""},Bo={class:"text-red-10"};function qo(a,s,l,o,_,h){const i=q("DisciplinasForm"),g=q("showInformation");return f(),p("div",null,[So,xo,e(ao,{flat:"",dense:"",bordered:"",rows:o.rows,columns:o.columns,"row-key":"id",filter:o.filter,loading:o.loading,class:"q-mt-lg"},{"top-left":c(()=>[r("span",null,[r("div",Eo,[e(A,{name:"mdi-book",size:"md"}),V(" Disciplinas [ "),r("b",Bo,m(o.disciplinasCountByEscolaId(o.escolaId)),1),V(" ] ")])])]),"top-right":c(()=>[e(z,{color:"primary",modelValue:o.filter,"onUpdate:modelValue":s[0]||(s[0]=n=>o.filter=n),lable:"Pesquisar",placeholder:"Pesquisar",dense:"",outlined:"",class:"q-mr-md"},{append:c(()=>[e(A,{name:"search"})]),_:1},8,["modelValue"]),e(W),e(v,{outline:"",color:"primary",disable:o.loading,label:"Novo disciplina",onClick:o.formModal,"no-caps":"",icon:"mdi-database-plus",filter:o.filter},null,8,["disable","onClick","filter"])]),"body-cell-options":c(n=>[e(eo,{props:n},{default:c(()=>[e(v,{flat:"",dense:"",icon:"mdi-delete-outline",color:"red-9",onClick:I=>o.remove(n.row.id),loading:o.loading,size:"sm"},null,8,["onClick","loading"]),e(v,{flat:"",dense:"",icon:"mdi-information-outline",color:"grey-9",onClick:I=>o.information(n.row),size:"sm"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","filter","loading"]),e(i,{modelValue:o.showModal,"onUpdate:modelValue":s[1]||(s[1]=n=>o.showModal=n),disciplina:o.disciplina,onSave:o.handleSave,loading:o.loading,isEditForm:o.formStatus,cursos:o.cursos,nome:"disciplina"},null,8,["modelValue","disciplina","onSave","loading","isEditForm","cursos"]),e(g,{modelValue:o.showModal2,"onUpdate:modelValue":s[2]||(s[2]=n=>o.showModal2=n),showInformation:o.DisciplinaInfo,disciplinasCursos:o.disciplinasCursos,nome:"disciplina"},null,8,["modelValue","showInformation","disciplinasCursos"])])}var rl=Q(ko,[["render",qo]]);export{rl as default};
