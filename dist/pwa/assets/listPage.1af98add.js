import{_ as V,G as D,r as $,P as S,R as A,o as B,k as L,S as x,H as t,I as d,J as o,T as f,K as a,V as p,aY as M,a0 as _,Q as R,X as l,L as c,M as n,W as b,Y as q,Z as U,$ as O,s as Y,U as F,N as v,aE as G}from"./index.35821edc.js";import{Q as H}from"./QSpace.d25d6d7b.js";import{Q as I}from"./QTooltip.9e866038.js";import{Q as J}from"./QTd.7f0ab490.js";import{Q as K}from"./QTable.516d2110.js";import{a as W,Q as N}from"./QMenu.c301a8bc.js";import{Q as y}from"./QItemLabel.ce2d3637.js";import{Q as X}from"./QList.7454f32f.js";import{Q as Z}from"./QPageSticky.0b6d8f0a.js";import{Q as j}from"./QPage.a66fc822.js";import{a as ee,b as ae}from"./QLayout.d35a44ea.js";import{u as oe}from"./userApi.885d4b06.js";import{u as se}from"./useNotify.4729e429.js";import{u as te}from"./use-quasar.0c1c42d6.js";import{b as le,i as re}from"./inputVisual.14accdd7.js";import{s as ne}from"./vue-json-excel.esm.c8461bbc.js";import"./selection.364e49a0.js";import"./QSelect.e06743c9.js";import"./rtl.b51694b1.js";import"./use-fullscreen.61378003.js";const ie=[{name:"name",label:"Nome de escola",align:"left",field:"name",sortable:!0},{name:"numero",label:"N\xBA da escola",align:"left",field:"numero",sortable:!0},{name:"provincia",label:"Prov\xEDncia",align:"left",field:"provincia",sortable:!0},{name:"municipio",label:"Munic\xEDpio",align:"left",field:"municipio",sortable:!0},{name:"actions",label:"Op\xE7\xF5es",align:"left",field:"actions",sortable:!0}],ce={"Nome da escola":"nome","N\xBA da escola":"numero","N\xBA do decreto":"num_decreto",Prov\u00EDncia:"provincia",Munic\u00EDpio:"municipio",Comuna:"comuna","Natureza da escola":"natureza_escola","Total de salas para professores":"salas_professores","Total de salas para alunos":"salas_alunos","Tipo de escola":"tipo_escola"};const me=D({components:{DownloadExcel:ne},setup(){const e=$([]),{list:u,remove:Q}=oe(),{user:r}=S(),k=A(),h=$(""),g=te(),s="escolas",{notifyError:m,notifySuccess:P}=se(),C=async()=>{f.show({message:"Carregado escolas"});try{e.value=await u(s,w.value)}catch(i){m(i.message)}finally{f.hide()}},E=async i=>{try{g.dialog({title:"Confirma\xE7\xE3o",message:`tens a certeza que pretendes eliminar ${i.nome} ?`,cancel:!0,persistent:!0}).onOk(async()=>{f.show({message:"Apagando escola..."}),await Q(s,i.id),C(),P("Escola apagada com sucesso")})}catch(T){m(T.message)}finally{f.hide()}},z=i=>{k.push({name:"form-escola",params:{id:i.id}})};B(()=>{C()});const w=L(()=>r.value.id!=r.value.user_metadata.organization_id?(console.log(r.value.user_metadata.organization_id),r.value.user_metadata.organization_id):(console.log(r.value.id),r.value.id));return{columns:ie,alterarItem:z,deletarItem:E,escolas:e,btnConfig:le,inputConfig:re,fields:ce,filter:h,isDiferentID:w}}}),de={key:0,class:"row"},ue={key:1,class:"flex flex-center text-body1 text-center"},fe={class:"row text-body3 text-h5 flex-center q-pa-lg bg-secondary text-white"},pe={class:"secondary"},ge={class:"secondary"},_e={key:3,class:"flex flex-center text-body1 text-center"};function be(e,u,Q,r,k,h){const g=x("download-excel");return t(),d(ee,null,{default:o(()=>[a(ae,null,{default:o(()=>[a(j,{padding:""},{default:o(()=>[e.$q.platform.is.desktop&&e.escolas!=null?(t(),p("div",de,[a(K,{rows:e.escolas,flat:"",bordered:"",columns:e.columns,"row-key":"id",class:"col-12","virtual-scroll":"",filter:e.filter},{top:o(()=>[a(M,_({class:"",type:"text",label:"Pesquisar"},{...e.inputConfig},{modelValue:e.filter,"onUpdate:modelValue":u[0]||(u[0]=s=>e.filter=s)}),{prepend:o(()=>[a(R,{name:"mdi-magnify"})]),_:1},16,["modelValue"]),a(H),e.$q.platform.is.desktop?(t(),d(l,_({key:0,icon:"mdi-plus",label:"Cadastrar nova escola",to:{name:"form-escola"}},{...e.btnConfig}),null,16)):c("",!0),a(g,{data:e.escolas,fields:e.fields,worksheet:"Escolas",name:"Escolas.xls",class:"q-ml-md"},{default:o(()=>[a(l,_({icon:"mdi-file-excel",label:"Exportar uma lista"},{...e.btnConfig}),null,16)]),_:1},8,["data","fields"])]),"body-cell-actions":o(s=>[a(J,{props:s,class:"q-gutter-x-sm text-center"},{default:o(()=>[a(l,{flat:"",icon:"mdi-pencil-outline",color:"info",dense:"",size:"sm",onClick:m=>e.alterarItem(s.row)},{default:o(()=>[a(I,null,{default:o(()=>[n("Alterar")]),_:1})]),_:2},1032,["onClick"]),a(l,{flat:"",icon:"mdi-delete-outline",color:"negative",dense:"",size:"sm",onClick:m=>e.deletarItem(s.row)},{default:o(()=>[a(I,null,{default:o(()=>[n("Apagar")]),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","filter"])])):c("",!0),e.$q.platform.is.desktop&&e.escolas==null?(t(),p("div",ue,[a(l,{flat:"",color:"red"},{default:o(()=>[n(" De momento n\xE3o tens nenhuma escola cadastrada ")]),_:1})])):c("",!0),e.$q.platform.is.mobile&&e.escolas!=null?(t(),d(X,{key:2,bordered:""},{default:o(()=>[b("div",fe,[a(l,{flat:"",icon:"mdi-school-outline",label:"Escolas"})]),a(q),(t(!0),p(O,null,U(e.escolas,s=>Y((t(),d(W,{key:s.id,class:"q-mb-sm",clickable:"",onClick:m=>e.alterarItem(s)},{default:o(()=>[a(N,{avatar:""},{default:o(()=>[a(F,{color:"primary","text-color":"white",icon:"mdi-school-outline"})]),_:1}),a(N,null,{default:o(()=>[a(y,null,{default:o(()=>[n(v(s.name),1)]),_:2},1024),a(y,{caption:"",lines:"1"},{default:o(()=>[n("N\xBA da escola: "),b("strong",pe,v(s.numero),1)]),_:2},1024),a(y,{caption:"",lines:"1"},{default:o(()=>[n("N\xBA do decreto: "),b("strong",ge,v(s.num_decreto),1)]),_:2},1024)]),_:2},1024),a(q)]),_:2},1032,["onClick"])),[[G]])),128))]),_:1})):c("",!0),e.$q.platform.is.mobile&&e.escolas==null?(t(),p("div",_e,[a(l,{color:"red"},{default:o(()=>[n(" De momento n\xE3o tens nenhuma escola cadastrada ")]),_:1})])):c("",!0),e.$q.platform.is.mobile?(t(),d(Z,{key:4,class:"margin-bottom",position:"bottom-right",offset:[18,18]},{default:o(()=>[a(l,{fab:"",icon:"mdi-plus",color:"primary",to:{name:"form-escola"}})]),_:1})):c("",!0)]),_:1})]),_:1})]),_:1})}var Le=V(me,[["render",be],["__scopeId","data-v-b93b1c80"]]);export{Le as default};
