import{_ as P,r as g,p as d,q as r,s as t,t as o,aS as A,H as e,F as C,x as l,y as i,aR as j,J as w,I as m,aT as G,bm as K,z as R,G as F,bq as ce,aZ as E,N,n as de,C as O,D as re,f as me,E as V,Q as ue,v as S,K as H,L as _e,M as fe}from"./index.bc90a1a6.js";import{Q as he}from"./QSpace.e93ae0b1.js";import{Q as U}from"./QTd.6b6bfcad.js";import{Q as z}from"./QTooltip.059a9529.js";import{Q as ge}from"./QTable.da9f4085.js";import{a as D,Q as y}from"./position-engine.8c426333.js";import{Q as x}from"./QItemLabel.d3c30afe.js";import{Q as Y}from"./QList.ac9043eb.js";import{Q as pe}from"./QBtnDropdown.eeb13d3b.js";import{Q as be}from"./QPageSticky.981a4856.js";import{Q as ye}from"./QPage.f48c0666.js";import{a as ve,b as xe}from"./QLayout.c9624849.js";import{C as k}from"./ClosePopup.36ee2ee1.js";import{u as J}from"./userApi.9d724f7f.js";import{u as Ce}from"./useNotify.98763d5b.js";import{u as B}from"./use-quasar.c935fd80.js";import{f as W}from"./formatCurrency.6090a7ed.js";import{Q as we}from"./QForm.d8ddec26.js";import{i as Z,b as ke}from"./inputVisual.14accdd7.js";import{s as Qe}from"./vue-json-excel.esm.ee4efc73.js";import"./selection.bbfae355.js";import"./QSelect.1664c3a2.js";import"./QMenu.456c4d11.js";import"./rtl.b51694b1.js";import"./use-fullscreen.28de194d.js";const qe=[{name:"img_url",label:"Imagem",align:"left",field:"img_url",sortable:!0},{name:"name",label:"Nome completo",align:"left",field:"name",sortable:!0},{name:"num_bilhete",label:"N\xBA do bilhete",align:"left",field:"num_bilhete",sortable:!0},{name:"num_agente",label:"N\xBA de agente",align:"left",field:"num_agente",sortable:!0},{name:"habilitacao",label:"Habilita\xE7\xE3o",align:"left",field:"habilitacao",sortable:!0},{name:"actions",label:"Op\xE7\xF5es",align:"left",field:"actions"}],De={name:"modalDetail",props:{itens:{type:Object},show:{type:Boolean,required:!0}},setup(s,{emit:u}){const a=g([]);return B(),{handClose:()=>{u("closeModal")},funcionarios:a,formatCurrency:W}}},Ae={class:"text-h6"},Ne={class:"row q-gutter-y-sm"},Ie={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-6"},Se={class:"text-body1"},ze={class:"text-blue-grey-5"},Fe={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-6"},Me={class:"text-body1"},Ve={class:"text-blue-grey-5"},Ee={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-6"},Pe={class:"text-body1"},Be={class:"text-blue-grey-5"},Le={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-6"},$e={class:"text-body1"},Te={class:"text-blue-grey-5"},Oe={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-6"},He={class:"text-body1"},Ue={class:"text-blue-grey-5"},Ye={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-6"},je={class:"text-body1"},Ge={class:"text-blue-grey-5"},Ke={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-6"},Re={class:"text-body1"},Je={class:"text-blue-grey-5"},We={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-6"},Ze={class:"text-body1"},Xe={class:"text-blue-grey-5"},eo={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-6"},oo={class:"text-body1"},to={class:"text-blue-grey-5"},so={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-6"},ao={class:"text-body1"},lo={class:"text-blue-grey-5"},no={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-6"},io={class:"text-body1"},co={class:"text-blue-grey-5"},ro={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-6"},mo={class:"text-body1"},uo={class:"text-blue-grey-5"},_o={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-6"},fo={class:"text-body1"},ho={class:"text-green-10"},go={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-6"},po={class:"text-body1"},bo={class:"text-green-10"},yo={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-6"},vo={class:"text-body1"},xo={class:"text-blue-grey-5"},Co={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-6"},wo={class:"text-body1"},ko={class:"text-blue-grey-5"},Qo={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-6"},qo={class:"text-body1"},Do={class:"text-blue-grey-5"},Ao={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-6"},No={class:"text-body1"},Io={class:"text-blue-grey-5"},So={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-6"},zo={class:"text-body1"},Fo={class:"text-blue-grey-5"},Mo={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-6"},Vo={class:"text-body1"},Eo={class:"text-blue-grey-5"},Po={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-6"},Bo={class:"text-body1"},Lo={class:"text-blue-grey-5"},$o={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-6"},To={class:"text-body1"},Oo={class:"text-blue-grey-5"},Ho={class:"col-xs-12 col-sm-12 col-12"},Uo={class:"text-body1"},Yo={class:"text-red-5"};function jo(s,u,a,c,v,p){return d(),r(K,{"model-value":a.show,persistent:"","full-width":s.$q.platform.mobile},{default:t(()=>[o(G,{style:{width:"700px","max-width":"80vw"}},{default:t(()=>[o(A,null,{default:t(()=>[e("div",Ae,[o(C,{icon:"mdi-account-details"}),l(" Mais detalhes ")])]),_:1}),o(A,{class:"q-pt-none"},{default:t(()=>[e("div",Ne,[e("div",Ie,[e("span",Se,[l("Nome completo: "),e("span",ze,i(a.itens.name),1)])]),e("div",Fe,[e("span",Me,[l("Nome do pai: "),e("span",Ve,i(a.itens.nome_pai),1)])]),e("div",Ee,[e("span",Pe,[l("Nome da ma\xEA: "),e("span",Be,i(a.itens.nome_mae),1)])]),e("div",Le,[e("span",$e,[l("N\xBA do Bilhete: "),e("span",Te,i(a.itens.num_bilhete),1)])]),e("div",Oe,[e("span",He,[l("Data de emiss\xE3o: "),e("span",Ue,i(a.itens.data_emissao),1)])]),e("div",Ye,[e("span",je,[l("Data de validade: "),e("span",Ge,i(a.itens.data_caducidade),1)])]),e("div",Ke,[e("span",Re,[l("Data de nascimento: "),e("span",Je,i(a.itens.data_nascimento),1)])]),e("div",We,[e("span",Ze,[l("Prov\xEDncia: "),e("span",Xe,i(a.itens.provincia),1)])]),e("div",eo,[e("span",oo,[l("Munic\xEDpio: "),e("span",to,i(a.itens.municipio),1)])]),e("div",so,[e("span",ao,[l("Comuna: "),e("span",lo,i(a.itens.comuna),1)])]),e("div",no,[e("span",io,[l("Localidade/Bairro: "),e("span",co,i(a.itens.localidade),1)])]),e("div",ro,[e("span",mo,[l("Categoria: "),e("span",uo,i(a.itens.categorias.categoria),1)])]),e("div",_o,[e("span",fo,[l("Vencimento Base: "),e("span",ho,i(c.formatCurrency(a.itens.salario_base)),1)])]),e("div",go,[e("span",po,[l("Vencimento Liquido: "),e("span",bo,i(c.formatCurrency(a.itens.salario_liquido)),1)])]),e("div",yo,[e("span",vo,[l("Habilita\xE7\xE3o Liter\xE1: "),e("span",xo,i(a.itens.habilitacao),1)])]),e("div",Co,[e("span",wo,[l("\xC1rea de forma\xE7\xE3o: "),e("span",ko,i(a.itens.area_formacao),1)])]),e("div",Qo,[e("span",qo,[l("Instituto onde se formou: "),e("span",Do,i(a.itens.instituto_formacao),1)])]),e("div",Ao,[e("span",No,[l("N\xBA de agente: "),e("span",Io,i(a.itens.num_agente),1)])]),e("div",So,[e("span",zo,[l("Escola onde foi colocado: "),e("span",Fo,i(a.itens.escolas.nome),1)])]),e("div",Mo,[e("span",Vo,[l("G\xEAnero: "),e("span",Eo,i(a.itens.genero),1)])]),e("div",Po,[e("span",Bo,[l("Data de in\xEDcio de fun\xE7\xF5es: "),e("span",Lo,i(a.itens.data_inicio_funcao),1)])]),e("div",$o,[e("span",To,[l("Total de tempo em servi\xE7o: "),e("span",Oo,i(new Date().getFullYear()-new Date(a.itens.data_inicio_funcao).getFullYear()),1)])]),e("div",Ho,[e("span",Uo,[l("Total de tempo em falta para reforma: "),e("span",Yo,i(35-(new Date().getFullYear()-new Date(a.itens.data_inicio_funcao).getFullYear()))+" Anos",1)])])])]),_:1}),o(j,{align:"right",class:"bg-white text-teal"},{default:t(()=>[w(o(m,{flat:"",label:"OK",onClick:c.handClose},null,8,["onClick"]),[[k]])]),_:1})]),_:1})]),_:1},8,["model-value","full-width"])}var Go=P(De,[["render",jo]]);const Ko={name:"modalDetail",props:{itens:{type:Object},show:{type:Boolean,required:!0}},setup(s,{emit:u}){const a=g([]),c=B(),v="docFuncionario";g(!1);const{post:p,fileName:f,uploadImage:Q}=J(),h=g({nome_doc:"",file_name:"",url_documento:""}),n=g([]),_=()=>{u("closeModal")};return R(()=>{h.value.num_bilhete=s.itens.num_bilhete,h.value.id_funcionario=s.itens.id}),{handClose:_,funcionarios:a,formatCurrency:W,inputConfig:Z,onSubmit:async()=>{c.loading.show("Salvando documento...");try{n.value.length>0&&await Q(n.value[0],"docFuncionarios").then(q=>{h.value.url_documento=q,h.value.file_name=f});const{}=h.value;await p(v,{...h.value,id_funcionario:s.itens.id,num_bilhete:s.itens.num_bilhete}),c.notify({color:"positive",position:"top",message:"Documento arquivado com sucesso",icon:"mdi-check"}),_()}catch(q){c.notify({color:"negative",position:"top",message:"Erro ao arquivar o documento"+q.message,icon:"report_problem"})}finally{c.loading.hide()}},form:h,doc:n}}},Ro={class:"text-h6"},Jo={key:0,style:{"font-size":"14px"}},Wo={key:1},Zo={class:"q-pl-sm"},Xo=e("span",{class:"text-white"},"Nome: ",-1),et={class:"text-white"};function ot(s,u,a,c,v,p){return d(),r(K,{"model-value":a.show,persistent:"","full-width":s.$q.platform.mobile},{default:t(()=>[o(G,{style:{width:"800px","max-width":"100vw"}},{default:t(()=>[o(A,null,{default:t(()=>[e("div",Ro,[o(C,{icon:"mdi-file-document-multiple"}),s.$q.platform.is.mobile?(d(),F("span",Jo,"Arquivar documento do Funcion\xE1rio")):(d(),F("span",Wo,"Arquivar documento do Funcion\xE1rio"))])]),_:1}),o(we,{onSubmit:ce(c.onSubmit,["prevent"]),class:"q-gutter-md"},{default:t(()=>[o(A,{class:"bg-primary"},{default:t(()=>[e("span",Zo,[Xo,e("b",et,i(a.itens.name),1)])]),_:1}),o(A,{class:"q-gutter-sm"},{default:t(()=>[o(E,N({label:"Carregue um documento","stack-label":"",modelValue:c.doc,"onUpdate:modelValue":u[0]||(u[0]=f=>c.doc=f),multiple:"",filled:"",type:"file",accept:".pdf"},{...c.inputConfig},{"lazy-rules":"",rules:[f=>!!f||"Porfavor carregue um documento"]}),null,16,["modelValue","rules"]),o(E,N({modelValue:c.form.nome_doc,"onUpdate:modelValue":u[1]||(u[1]=f=>c.form.nome_doc=f),label:"Nome do Documento"},{...c.inputConfig},{"lazy-rules":"",rules:[f=>!!f||"Porfavor informe o nome do documento"]}),null,16,["modelValue","rules"])]),_:1}),o(j,{align:"right",class:"q-gutter-sm bg-white text-teal"},{default:t(()=>[w(o(m,{icon:"mdi-close",flat:"",label:"Fechar",onClick:c.handClose},null,8,["onClick"]),[[k]]),o(m,{icon:"mdi-content-save-outline",type:"submit",flat:"",label:"Arquivar"})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["model-value","full-width"])}var tt=P(Ko,[["render",ot]]);const st={"Nome completo":"name","Nome do Pai":"nome_pai","Nome da ma\xEA":"nome_mae","N\xBA do bilhete":"num_bilhete","Data de emiss\xE3o":"data_emissao","Data de validade":"data_caducidade","Data de nascimento":"data_nascimento",Prov\u00EDncia:"provincia",Munic\u00EDpio:"municipio",Comuna:"comuna","Localidade/Bairro":"localidade",Categorias:"categorias.categoria",Habilita\u00E7\u00E3o:"habilitacao","\xC1rea de forma\xE7\xE3o":"area_formacao","Instituto onde se formou":"instituto_formacao","N\xBA de agente":"num_agente","N\xBA de agente":"num_agente","Escola onde colocado":"escolas.nome"};const at=de({components:{detalhesComponent:Go,DownloadExcel:Qe,addDoc:tt},setup(){const s=g([]),u=g(""),{remove:a,getFuncionariosWithCategoriasAndEscolas:c}=J(),v=O(),{user:p}=O(),f=re(),Q="sgdme",h=g(!1),n=g(!1),_=B(),I=g([]),q=g(!1),X=g(""),L="funcionarios",{notifyError:ee,notifySuccess:oe}=Ce(),$=g([]),te=b=>{I.value=b,h.value=!0},se=()=>{h.value=!1,n.value=!1},ae=b=>{I.value=b,n.value=!0},le=async b=>{try{_.dialog({title:"Confirma\xE7\xE3o",message:`tens a certeza que pretendes eliminar ${b.nome} ?`,cancel:!0,persistent:!0}).onOk(async()=>{_.loading.show({message:"Apagando dados do funcion\xE1rios..."}),await a(L,b.id),M(),oe("Dados do funcion\xE1rio apagado com sucesso")})}catch(ie){ee(ie.message)}finally{_.loading.hide()}},ne=b=>{f.push({name:"form-funcionario",params:{id:b.id}})};R(()=>{M()});const M=async()=>{try{$.value=await c(L,T)}catch(b){console.log(b)}finally{}},T=me(()=>p.value.id!=p.value.user_metadata.organization_id?(console.log(p.value.user_metadata.organization_id),p.value.user_metadata.organization_id):(console.log(p.value.id),p.value.id));return{columns:qe,alterarItem:ne,deletarItem:le,funcionarios:s,storage:Q,token:v,detalhes:te,card:q,itensDetails:u,itens:I,handleShowDetail:h,handleShowAddDoc:n,addDoc:ae,btnConfig:ke,inputConfig:Z,fields:st,listarFuncionariosComCategoria:M,funcionarioCategoriasAndEscolas:$,filter:X,closeModal:se,isDiferentID:T}}}),lt={key:0,class:"row"},nt=["src"],it={class:"row text-body3 text-h5 flex-center q-pa-lg bg-secondary text-white"},ct=["src"],dt={class:"secondary"};function rt(s,u,a,c,v,p){const f=V("download-excel"),Q=V("detalhes-component"),h=V("add-doc");return d(),r(ve,null,{default:t(()=>[o(xe,null,{default:t(()=>[o(ye,{padding:""},{default:t(()=>[s.$q.platform.is.desktop?(d(),F("div",lt,[o(ge,{rows:s.funcionarioCategoriasAndEscolas,flat:"",bordered:"",columns:s.columns,"row-key":"id",class:"col-12","virtual-scroll":""},{top:t(()=>[o(E,N({dense:"",type:"text",label:"Pesquisar",modelValue:s.filter,"onUpdate:modelValue":u[0]||(u[0]=n=>s.filter=n)},{...s.inputConfig}),{prepend:t(()=>[o(ue,{name:"mdi-magnify"})]),_:1},16,["modelValue"]),o(he),s.$q.platform.is.desktop?(d(),r(m,N({key:0,icon:"mdi-plus",label:"Cadastrar novo funcionario",to:{name:"form-funcionario"}},{...s.btnConfig}),null,16)):S("",!0),o(f,{data:s.funcionarioCategoriasAndEscolas,fields:s.fields,worksheet:"funcionarios",name:"Funcionarios.xls",class:"q-ml-md"},{default:t(()=>[o(m,N({icon:"mdi-file-excel",label:"Exportar uma lista"},{...s.btnConfig}),null,16)]),_:1},8,["data","fields"])]),"body-cell-img_url":t(n=>[o(U,{props:n,class:"text-center"},{default:t(()=>[n.row.img_url?(d(),r(C,{key:0},{default:t(()=>[e("img",{src:n.row.img_url},null,8,nt)]),_:2},1024)):(d(),r(C,{key:1,color:"secondary","text-color":"white",icon:"mdi-image-off",class:"flex-center"}))]),_:2},1032,["props"])]),"body-cell-actions":t(n=>[o(U,{props:n,class:"q-gutter-x-sm text-center"},{default:t(()=>[o(m,{icon:"mdi-eye-outline",color:"grey",dense:"",size:"sm",flat:"",onClick:_=>s.detalhes(n.row)},{default:t(()=>[o(z,null,{default:t(()=>[l("Ver detalhes")]),_:1})]),_:2},1032,["onClick"]),o(m,{icon:"mdi-pencil-outline",color:"info",dense:"",size:"sm",flat:"",onClick:_=>s.alterarItem(n.row)},{default:t(()=>[o(z,null,{default:t(()=>[l("Alterar")]),_:1})]),_:2},1032,["onClick"]),o(m,{icon:"mdi-delete-outline",color:"negative",dense:"",size:"sm",flat:"",onClick:_=>s.deletarItem(n.row)},{default:t(()=>[o(z,null,{default:t(()=>[l("Apagar")]),_:1})]),_:2},1032,["onClick"]),o(m,{icon:"mdi-plus",color:"positive",dense:"",flat:"",size:"sm",onClick:_=>s.addDoc(n.row)},{default:t(()=>[o(z,null,{default:t(()=>[l("Adicionar documentos")]),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])])):S("",!0),s.$q.platform.is.mobile&&s.funcionarioCategoriasAndEscolas!=""?(d(),r(Y,{key:1,bordered:""},{default:t(()=>[e("div",it,[o(m,{flat:"",icon:"mdi-account-tie",label:"Funcion\xE1rios"})]),o(H),(d(!0),F(fe,null,_e(s.funcionarioCategoriasAndEscolas,n=>(d(),r(D,{key:n.id,class:"q-mb-sm q-mt-sm"},{default:t(()=>[o(y,{avatar:""},{default:t(()=>[n.img_url?(d(),r(C,{key:0},{default:t(()=>[e("img",{src:n.img_url},null,8,ct)]),_:2},1024)):(d(),r(C,{key:1,color:"grey","text-color":"white",icon:"mdi-image-off"}))]),_:2},1024),o(y,null,{default:t(()=>[o(x,null,{default:t(()=>[l(i(n.name),1)]),_:2},1024),o(x,{caption:"",lines:"1"},{default:t(()=>[l("N\xBA de agente: "),e("strong",dt,i(n.num_agente),1)]),_:2},1024)]),_:2},1024),o(y,{side:"",top:""},{default:t(()=>[e("div",null,[o(pe,{flat:"","dropdown-icon":"mdi-dots-vertical","no-icon-animation":""},{default:t(()=>[o(Y,null,{default:t(()=>[w((d(),r(D,{clickable:"",onClick:_=>s.alterarItem(n)},{default:t(()=>[o(y,null,{default:t(()=>[o(x,null,{default:t(()=>[o(m,{dense:"",flat:"",size:"sm","no-caps":"",icon:"mdi-file-edit",color:"green-10",label:"Alterar"})]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[k]]),w((d(),r(D,{clickable:"",onClick:_=>s.detalhes(n)},{default:t(()=>[o(y,null,{default:t(()=>[o(x,null,{default:t(()=>[o(m,{dense:"",flat:"",size:"sm",label:"Mais detalhes",icon:"mdi-eye-outline",color:"blue-grey-8"})]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[k]]),w((d(),r(D,{clickable:"",onClick:_=>s.deletarItem(n)},{default:t(()=>[o(y,null,{default:t(()=>[o(x,null,{default:t(()=>[o(m,{dense:"",flat:"",size:"sm",label:"Apagar",icon:"mdi-delete-circle-outline",color:"red-8"})]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[k]]),w((d(),r(D,{clickable:"",onClick:_=>s.addDoc(n)},{default:t(()=>[o(y,null,{default:t(()=>[o(x,null,{default:t(()=>[o(m,{icon:"cloud_upload",color:"positive",label:"Arquivar documentos",dense:"",flat:"",size:"sm","no-caps":""})]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[k]])]),_:2},1024)]),_:2},1024)])]),_:2},1024),o(H)]),_:2},1024))),128))]),_:1})):S("",!0),s.$q.platform.is.mobile?(d(),r(be,{key:2,class:"margin-bottom",position:"bottom-right",offset:[18,18]},{default:t(()=>[o(m,{fab:"",icon:"mdi-plus",color:"primary",to:{name:"form-funcionario"}})]),_:1})):S("",!0),o(Q,{show:s.handleShowDetail,itens:s.itens,onCloseModal:s.closeModal},null,8,["show","itens","onCloseModal"]),o(h,{show:s.handleShowAddDoc,itens:s.itens,onCloseModal:s.closeModal},null,8,["show","itens","onCloseModal"])]),_:1})]),_:1})]),_:1})}var Et=P(at,[["render",rt],["__scopeId","data-v-4d135fc5"]]);export{Et as default};
