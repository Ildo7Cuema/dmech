import{_ as S,r as t,w as C,p as g,q as N,s as i,t as e,aS as I,F as A,G as T,bq as W,aZ as F,aR as D,J as U,I as _,aT as P,bm as z,f as Z,H as m,y as d,x as f,C as K,z as L,E,Q as q}from"./index.e70dc7e8.js";import{Q as Y}from"./QSpace.cccfce51.js";import{Q as X}from"./QTd.e931d9bd.js";import{Q as $}from"./QTable.324e303e.js";import{u as oo}from"./turmas.a4794dff.js";import{u as eo}from"./cursos.717f0f89.js";import{Q as lo}from"./QSelect.9e4cb652.js";import{Q as ao}from"./QForm.7b26f9a5.js";import{C as O}from"./ClosePopup.39a76e78.js";import{h as no}from"./moment.40bc58bf.js";import"./QList.9cd80ca5.js";import"./use-fullscreen.63635d9e.js";import"./useNotify.e83fbf31.js";import"./position-engine.1f1eaf41.js";import"./selection.ded15137.js";import"./QItemLabel.f0026656.js";import"./QMenu.704bcb1b.js";import"./rtl.b51694b1.js";const ro={props:{cursos:{type:Array},Turma:{type:Object},showModal:Boolean,loading:Boolean,isEditForm:Boolean},emits:["save"],setup(r,{emit:l}){const n=t({nome_turma:"",curso_id:"",escola_id:"",num_sala:"",ano:""}),o=t(!1),h=()=>{l("save",n.value)},v=()=>{n.value={nome_turma:"",curso_id:"",escola_id:"",num_sala:"",ano:""},o.value=!1};return C(()=>r.Turma,a=>{a&&(n.value={...a},o.value=!0)},{immediate:!0}),C(()=>r.showModal,a=>{show.value=a}),C(()=>r.isEditForm,a=>{o.value=a}),C(()=>r.loading,a=>{a!=!0&&(n.value.nome_turma="",n.value.escola_id="",n.value.curso_id="",n.value.ano="")}),{form:n,emitForm:h,show:t(r.showModal),statusForm:t(r.isEditForm),closeForm:v}}},so={key:0,class:"q-ml-sm"},to={key:1,class:"q-ml-sm"};function io(r,l,n,o,h,v){return g(),N(z,{modelValue:o.show,"onUpdate:modelValue":l[4]||(l[4]=a=>o.show=a),persistent:""},{default:i(()=>[e(P,null,{default:i(()=>[e(I,{class:"row items-center"},{default:i(()=>[e(A,{icon:n.isEditForm?"mdi-file-edit":"mdi-school",color:n.isEditForm?"green-9":"dark","text-color":"white"},null,8,["icon","color"]),n.isEditForm?(g(),T("span",so,"Alterar Turma")):(g(),T("span",to,"Cadastro de nova Turma"))]),_:1}),e(ao,{onSubmit:W(o.emitForm,["prevent"])},{default:i(()=>[e(I,{class:"row q-col-gutter-sm"},{default:i(()=>[e(F,{modelValue:o.form.nome_turma,"onUpdate:modelValue":l[0]||(l[0]=a=>o.form.nome_turma=a),label:"Nome da Turma",dense:"",outlined:"",clearable:"",placeholder:"Nome",class:"col-xs-12 col-sm-12 col-md-6 col-lg-6",rules:[a=>!!a||"Porfavor informe o nome do Turma"]},null,8,["modelValue","rules"]),e(lo,{modelValue:o.form.curso_id,"onUpdate:modelValue":l[1]||(l[1]=a=>o.form.curso_id=a),label:"Curso",dense:"",outlined:"",clearable:"",placeholder:"Selecione um curso",class:"col-xs-12 col-sm-12 col-md-6 col-lg-6",options:n.cursos,rules:[a=>!!a||"Por favor selecione um curso"],"option-value":"id","option-label":"nome_curso","map-options":"","emit-value":""},null,8,["modelValue","options","rules"]),e(F,{type:"number",modelValue:o.form.num_sala,"onUpdate:modelValue":l[2]||(l[2]=a=>o.form.num_sala=a),label:"N\xFAmero da Sala",dense:"",outlined:"",clearable:"",placeholder:"N\xFAmero da Sala",class:"col-xs-12 col-sm-12 col-md-6 col-lg-6",rules:[a=>!!a||"Por favor informe o n\xFAmero da sala"]},null,8,["modelValue","rules"])]),_:1}),e(D,{class:"bg-grey-3"},{default:i(()=>[U(e(_,{outline:"","no-caps":"",label:"Cancelar",color:"red-9",icon:"mdi-close",onClick:l[3]||(l[3]=a=>o.closeForm())},null,512),[[O]]),e(Y),e(_,{type:"submit",outline:"","no-caps":"",label:n.isEditForm?"Actualizar":"Cadastrar",color:"green-10",icon:n.isEditForm?"mdi-update":"mdi-database-plus",loading:n.loading},null,8,["label","icon","loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])}var mo=S(ro,[["render",io]]);const uo={props:{nome:String,showModal2:Boolean,showInformation:{type:Object,required:!0}},setup(r){const l=no(r.showInformation.created_at).format("DD/MM/YYYY"),n=Z(()=>r.nome.endsWith("a")?"da":"do");return{momentDate:l,artigo:n,showInfor:t(r.showModal2)}}},co={class:"q-ml-sm"},fo=m("b",null,"Turma: ",-1),_o=m("b",null,"N\xBA de sala: ",-1),vo=m("b",null,"Pertence ao curso de: ",-1),ho=m("b",null,"Ano lectivo: ",-1),go=m("b",null,"Data de registo: ",-1);function wo(r,l,n,o,h,v){return g(),N(z,{modelValue:o.showInfor,"onUpdate:modelValue":l[0]||(l[0]=a=>o.showInfor=a),persistent:""},{default:i(()=>[e(P,null,{default:i(()=>[e(I,{class:"row items-center"},{default:i(()=>[e(A,{icon:"mdi-information-outline",color:"blue-4","text-color":"white",size:"50px"}),m("span",co,"Mais informa\xE7\xF5es "+d(o.artigo)+" "+d(n.nome),1)]),_:1}),e(I,{class:"row q-col-gutter-sm"},{default:i(()=>[m("p",null,[fo,f(d(n.showInformation.nome_turma),1)]),m("p",null,[_o,f(d(n.showInformation.num_sala),1)]),m("p",null,[vo,f(d(n.showInformation.curso.nome_curso),1)]),m("p",null,[ho,f(d(n.showInformation.ano),1)]),m("p",null,[go,f(d(o.momentDate),1)])]),_:1}),e(D,{class:"bg-grey-3"},{default:i(()=>[U(e(_,{outline:"","no-caps":"",label:"Fechar",color:"red-9",icon:"mdi-close"},null,512),[[O]])]),_:1})]),_:1})]),_:1},8,["modelValue"])}var bo=S(uo,[["render",wo]]);const yo=[{name:"nome_turma",label:"Nome da Turma",align:"left",field:"nome_turma",sortable:!0},{name:"curso.nome_curso",label:"Cursos",align:"left",field:r=>r.curso.nome_curso,sortable:!0},{name:"num_sala",label:"N\xFAmero da Sala",align:"left",field:"num_sala",sortable:!0},{name:"ano",label:"Ano lectivo",align:"left",field:"ano",sortable:!0},{name:"options",label:"Op\xE7\xF5es",align:"left",field:"options",sortable:!0}],Co={components:{turmasForm:mo,showInformation:bo},setup(){const r=t(!1),l=t(!1),{user:n}=K(),o=t(!1),v=new Date().getFullYear(),{addTurma:a,turmasCountByEscolaId:V,deleteTurmaById:u,getAllTurmas:w,getTurmaById:So,updateTurmaById:j,getEscolaIdByEmail:M}=oo(),{getAllCursos:G}=eo(),b=t(""),p=t(!1),H=t(""),J=t(""),Q=t({}),k=t([]),x=t({}),B=t([]);L(()=>{y(),R()});const y=()=>{r.value=!0,M(n.value.email).then(s=>{b.value=s,w(s).then(c=>{B.value=c,r.value=!1})})},R=()=>{r.value=!0,M(n.value.email).then(s=>{b.value=s,G(s).then(c=>{k.value=c,r.value=!1})})};return{rows:B,columns:yo,search:H,filter:J,loading:r,edit:s=>{console.log(s),Q.value={...s},l.value=!0,p.value=!0},remove:async s=>{r.value=!0;try{await u(s),y()}catch(c){console.log(c)}finally{y(),r.value=!1}},formModal:s=>{l.value=!1,p.value=!0},Turma:Q,showModal:p,handleSave:async s=>{console.log(s);try{r.value=!0,s.escola_id=b.value,s.ano=v,l.value?await j(s.id,s):await a(s)}catch(c){console.log(c)}finally{r.value=!1,y()}},formStatus:l,turmasCountByEscolaId:V,escolaId:b,information:s=>{console.log(s),x.value={...s},o.value=!0},showModal2:o,TurmaInfo:x,cursos:k}}},Io=m("br",null,null,-1),Vo=m("br",null,null,-1),po={class:""},To={class:"text-red-10"};function Fo(r,l,n,o,h,v){const a=E("turmasForm"),V=E("showInformation");return g(),T("div",null,[Io,Vo,e($,{flat:"",dense:"",bordered:"",rows:o.rows,columns:o.columns,"row-key":"id",filter:o.filter,loading:o.loading,class:"q-mt-lg"},{"top-left":i(()=>[m("span",null,[m("div",po,[e(q,{name:"mdi-school",size:"md"}),f(" Turmas [ "),m("b",To,d(o.turmasCountByEscolaId(o.escolaId)),1),f(" ] ")])])]),"top-right":i(()=>[e(F,{color:"primary",modelValue:o.filter,"onUpdate:modelValue":l[0]||(l[0]=u=>o.filter=u),lable:"Pesquisar",placeholder:"Pesquisar",dense:"",outlined:"",class:"q-mr-md"},{append:i(()=>[e(q,{name:"search"})]),_:1},8,["modelValue"]),e(Y),e(_,{outline:"",color:"primary",disable:o.loading,label:"Nova Turma",onClick:o.formModal,"no-caps":"",icon:"mdi-database-plus",filter:o.filter},null,8,["disable","onClick","filter"])]),"body-cell-options":i(u=>[e(X,{props:u},{default:i(()=>[e(_,{flat:"",dense:"",icon:"mdi-file-edit-outline",color:"green-9",onClick:w=>o.edit(u.row),size:"sm"},null,8,["onClick"]),e(_,{flat:"",dense:"",icon:"mdi-delete-outline",color:"red-9",onClick:w=>o.remove(u.row.id),loading:o.loading,size:"sm"},null,8,["onClick","loading"]),e(_,{flat:"",dense:"",icon:"mdi-information-outline",color:"grey-9",onClick:w=>o.information(u.row),size:"sm"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","filter","loading"]),e(a,{modelValue:o.showModal,"onUpdate:modelValue":l[1]||(l[1]=u=>o.showModal=u),Turma:o.Turma,onSave:o.handleSave,loading:o.loading,isEditForm:o.formStatus,cursos:o.cursos},null,8,["modelValue","Turma","onSave","loading","isEditForm","cursos"]),e(V,{modelValue:o.showModal2,"onUpdate:modelValue":l[2]||(l[2]=u=>o.showModal2=u),showInformation:o.TurmaInfo,nome:"turma"},null,8,["modelValue","showInformation"])])}var Lo=S(Co,[["render",Fo]]);export{Lo as default};
